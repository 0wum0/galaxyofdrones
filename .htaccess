# Root .htaccess - Protects non-public files if DocumentRoot is not set to /public
# This file is a safety net. Ideally, DocumentRoot should point to /public.

<IfModule mod_rewrite.c>
    RewriteEngine On

    # Redirect everything to the public directory
    RewriteCond %{REQUEST_URI} !^/public/
    RewriteRule ^(.*)$ /public/$1 [L]
</IfModule>

# Deny access to sensitive files in root
<FilesMatch "\.(env|log|yml|yaml|json|lock|xml|ini|conf|sh|sql|bak|md|php)$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Deny from all
    </IfModule>
</FilesMatch>

# Deny access to directories
Options -Indexes
