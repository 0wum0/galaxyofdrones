(self.webpackChunk=self.webpackChunk||[]).push([[773],{5077:(t,e,i)=>{"use strict";var n=i(538),r=i(8345),s=new n.default;const a=n.default.extend({data:function(){return{remaining:0,remainingInterval:void 0}},created:function(){s.$on("modal-hidden",this.clearRemaining)},beforeDestroy:function(){s.$off("modal-hidden",this.clearRemaining)},methods:{initRemaining:function(t){var e=this;this.clearRemaining(),this.remaining=t,this.remaining<1||(this.remainingInterval=setInterval((function(){e.remaining-=1,e.remaining||e.clearRemaining()}),1e3))},clearRemaining:function(){this.remainingInterval&&(this.remainingInterval=clearInterval(this.remainingInterval))}}}),o=a.extend({data:function(){return{$modal:void 0,isEnabled:!1}},mounted:function(){var t=this;this.$modal=$(this.$el).on("show.bs.modal",(function(){s.$emit("modal-show"),t.isEnabled=!0})).on("hidden.bs.modal",(function(){s.$emit("modal-hidden"),t.isEnabled=!1}))},watch:{$route:function(){this.close()}},methods:{openAfterHidden:function(t){var e=!1,i=function i(){e||(e=!0,clearTimeout(n),t(),s.$off("modal-hidden",i))};s.$on("modal-hidden",i),this.close();var n=setTimeout(i,400)},close:function(){this.$modal.modal("hide")}}}),c=o.extend({props:["url","destroyUrl"],data:function(){return{page:1,data:{current_page:1,from:0,last_page:1,to:0,total:0}}},created:function(){s.$on("bookmark-click",this.open)},computed:{isEmpty:function(){return 0===this.data.total},hasPrev:function(){return this.data.current_page>1},hasNext:function(){return this.data.current_page<this.data.last_page}},methods:{open:function(){this.page=1,this.fetchData(!0)},fetchData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(e||this.isEnabled)&&axios.get(this.url,{params:{page:this.page}}).then((function(i){t.data=i.data,e&&t.$nextTick((function(){return t.$modal.modal()}))}))},move:function(t){s.$emit("starmap-move",t.x,t.y),this.close()},destroy:function(t){var e=this;axios.delete(this.destroyUrl.replace("__bookmark__",t.id)).then((function(){e.page>1&&e.data.to-e.data.from==0?e.prevPage():e.fetchData()}))},prevPage:function(){this.changePage(this.page-1)},nextPage:function(){this.changePage(this.page+1)},changePage:function(t){this.page!==t&&(t<1||t>this.data.last_page||(this.page=t,this.fetchData()))}}}),u=o.extend({props:["url","storeUrl","destroyUrl"],data:function(){return{isSubscribed:!1,canDemolish:!1,energy:0,selected:{id:void 0},grid:{id:void 0,building_id:void 0},data:{remaining:0,buildings:[]}}},created:function(){var t=this;s.$on("grid-click",this.open),s.$on("energy-updated",(function(e){t.energy=e})),s.$on("planet-update",(function(){return t.fetchData()}))},computed:{canConstruct:function(){return this.energy>=this.selected.construction_cost}},methods:{open:function(t){this.grid=t,this.fetchData(!0)},fetchData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(e||this.isEnabled)&&axios.get(this.url.replace("__grid__",this.grid.id)).then((function(i){t.data=i.data,e&&t.data.buildings.length?(t.initRemaining(t.data.remaining),_.find(t.data.buildings,t.selected)||t.select(_.first(t.data.buildings)),e&&t.$nextTick((function(){return t.$modal.modal()}))):t.close()}))},store:function(){axios.post(this.storeUrl.replace("__grid__",this.grid.id).replace("__building__",this.selected.id))},destroy:function(){axios.delete(this.destroyUrl.replace("__grid__",this.grid.id))},isSelected:function(t){return this.selected.id===t.id},select:function(t){this.selected=t}}}),d=o.extend({props:["url"],data:function(){return{grid:{}}},created:function(){s.$on("demolish-open",this.open)},methods:{open:function(t){this.grid=t,this.$modal.modal()},demolish:function(){axios.delete(this.url.replace("__grid__",this.grid.id)).then(this.close)}}});var h=i(381),l=i.n(h);function p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,r=!1,s=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done)&&(i.push(a.value),!e||i.length!==e);n=!0);}catch(t){r=!0,s=t}finally{try{n||null==o.return||o.return()}finally{if(r)throw s}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return f(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}const m=function(t){return"(".concat(t,")")},g=function(t){var e=l()(t,"YYYY-MM-DD HH:mm:ss");return e.isValid()?e.fromNow():t},y=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"resource";return"".concat(e,"-").concat(t&&_.has(t,"id")?t.id:t)},v=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=Math.abs(t);return i>=Math.pow(10,13)?"".concat((t/Math.pow(10,12)).toFixed(e),"t"):i>=Math.pow(10,10)?"".concat((t/Math.pow(10,9)).toFixed(e),"b"):i>=Math.pow(10,7)?"".concat((t/Math.pow(10,6)).toFixed(e),"m"):i>=Math.pow(10,4)?"".concat((t/Math.pow(10,3)).toFixed(e),"k"):Math.round(t)},b=function(t){return"".concat((100*t).toFixed(0),"%")},x=function(t,e){var i=e;i||(i=t);var n=_.isNumber(t)?Math.abs(t):t;return i<0?"-".concat(n):"+".concat(n)},w=function(t){var e=Math.abs(t),i=[e/3600,e%3600/60,e%60],n=p(i=_.map(i,(function(t){return _.padStart(Math.floor(t),2,"0")})),3),r=n[0],s=n[1],a=n[2];return"".concat(r,":").concat(s,":").concat(a)},k=n.default.extend({props:{isEnabled:Boolean,url:{type:String,required:!0}},data:function(){return{page:1,data:{current_page:1,last_page:1,total:0}}},computed:{isEmpty:function(){return 0===this.data.total},hasPrev:function(){return this.data.current_page>1},hasNext:function(){return this.data.current_page<this.data.last_page},dataUrl:function(){return this.url}},watch:{isEnabled:function(){this.page=1,this.fetchData()}},created:function(){var t=this;s.$on("user-updated",(function(){return t.fetchData()}))},methods:{fetchData:function(){var t=this;this.isEnabled&&axios.get(this.dataUrl,{params:{page:this.page}}).then((function(e){t.data=e.data}))},prevPage:function(){this.changePage(this.page-1)},nextPage:function(){this.changePage(this.page+1)},changePage:function(t){this.page!==t&&(t<1||t>this.data.last_page||(this.page=t,this.fetchData()))}}}),j=k.extend({props:["openAfterHidden"],data:function(){return{collapsed:[]}},methods:{isCollapsed:function(t){return _.includes(this.collapsed,t.id)},collapse:function(t){var e=_.indexOf(this.collapsed,t.id);e>-1?this.collapsed.splice(e,1):this.collapsed.push(t.id)},openUser:function(t){this.openAfterHidden((function(){return s.$emit("profile-click",t)}))}}}),T=k.extend({props:["openAfterHidden"],data:function(){return{collapsed:[]}},methods:{isCollapsed:function(t){return _.includes(this.collapsed,t.id)},collapse:function(t){var e=_.indexOf(this.collapsed,t.id);e>-1?this.collapsed.splice(e,1):this.collapsed.push(t.id)},openUser:function(t){this.openAfterHidden((function(){return s.$emit("profile-click",t)}))},sendMessage:function(t){this.openAfterHidden((function(){return s.$emit("message-click",t)}))}}}),S={data:function(){return{selectedTab:""}},methods:{isSelectedTab:function(t){return this.selectedTab===t},selectTab:function(t){this.selectedTab=t}}},U=o.extend({components:{BattleLog:j,CompletionLog:k,MessageLog:T},mixins:[S],data:function(){return{selectedTab:"mission-log"}},created:function(){s.$on("mailbox-click",this.open)},methods:{open:function(){var t=this;this.$nextTick((function(){return t.$modal.modal()}))}}}),P=o.extend({props:["url"],data:function(){return{isSubmitted:!1,errors:{},form:{}}},created:function(){this.form=this.values()},computed:{method:function(){return"post"},parameters:function(){return JSON.parse(JSON.stringify(this.form))}},methods:{hasError:function(t){return _.has(this.errors,t)},values:function(){return{}},error:function(t){return _.first(this.errors[t])},submit:function(){this.isSubmitted||(this.isSubmitted=!0,axios[this.method](this.url,this.parameters).then(this.handleSuccess).catch(this.handleError))},handleSuccess:function(){this.isSubmitted=!1,this.errors={},this.close()},handleError:function(t){this.isSubmitted=!1,422===_.get(t,"response.status")&&(this.errors=_.get(t,"response.data.errors",{}))}}}),D=P.extend({created:function(){s.$on("message-click",this.open)},methods:{open:function(t){var e=this;this.form=this.values(),this.form.recipient=t,this.$nextTick((function(){return e.$modal.modal()}))},values:function(){return{recipient:"",message:""}}}}),E={props:["url"],data:function(){return{data:{incoming:0}}},created:function(){var t=this;s.$on("user-updated",(function(){return t.fetchData()}))},computed:{isEnabled:function(){return this.data.incoming>0}},methods:{fetchData:function(){var t=this;axios.get(this.url).then((function(e){t.data=e.data}))},openRadar:function(){s.$emit("mothership-click","radar")}}},M=a.extend({props:["completion","isCompletable","store"],created:function(){this.initRemaining(this.completion.remaining)},watch:{completion:function(){this.initRemaining(this.completion.remaining)}}}),A={props:["isEnabled","url","storeUrl"],components:{Completion:M},data:function(){return{data:{units:[],expeditions:[]}}},created:function(){var t=this;s.$on("planet-update",(function(){return t.fetchData()}))},computed:{isEmpty:function(){return!this.data.expeditions.length}},watch:{isEnabled:function(){this.fetchData()}},methods:{fetchData:function(){var t=this;this.isEnabled&&axios.get(this.url).then((function(e){t.data=e.data}))},isCompletable:function(t){var e=this;return!_.some(t.units,(function(t){return t.quantity>_.find(e.data.units,{id:t.id}).quantity}))},store:function(t){axios.post(this.storeUrl.replace("__expedition__",t.id))}}},q={props:["isEnabled","url","storeUrl"],components:{Completion:M},data:function(){return{data:{solarion:0,resources:[],missions:[]}}},created:function(){var t=this;s.$on("planet-update",(function(){return t.fetchData()}))},computed:{isEmpty:function(){return!this.data.missions.length}},watch:{isEnabled:function(){this.fetchData()}},methods:{fetchData:function(){var t=this;this.isEnabled&&axios.get(this.url).then((function(e){t.data=e.data}))},isCompletable:function(t){var e=this;return!_.some(t.resources,(function(t){return t.quantity>_.find(e.data.resources,{id:t.id}).quantity}))},store:function(t){axios.post(this.storeUrl.replace("__mission__",t.id))}}},C={props:["isEnabled","url","storeResourceUrl","storeUnitUrl","destroyResourceUrl","destroyUnitUrl"],components:{Research:a.extend({props:["research","isResearchable","store","destroy"],data:function(){return{isResearch:!0}},created:function(){this.initRemaining(this.research.remaining)},computed:{resource:function(){return this.research},unit:function(){return this.research}},watch:{research:function(){this.initRemaining(this.research.remaining)}}})},data:function(){return{energy:0,data:{resource:void 0,units:[]}}},created:function(){var t=this;s.$on("energy-updated",(function(e){t.energy=e})),s.$on("user-updated",(function(){return t.fetchData()}))},computed:{isEmpty:function(){return!this.data.resource&&!this.data.units.length}},watch:{isEnabled:function(){this.fetchData()}},methods:{fetchData:function(){var t=this;this.isEnabled&&axios.get(this.url).then((function(e){t.data=e.data}))},isResearchable:function(t){return this.energy>=t.research_cost},storeResource:function(){axios.post(this.storeResourceUrl)},destroyResource:function(){axios.delete(this.destroyResourceUrl)},storeUnit:function(t){axios.post(this.storeUnitUrl.replace("__unit__",t.id))},destroyUnit:function(t){axios.delete(this.destroyUnitUrl.replace("__unit__",t.id))}}},I=a.extend({props:["movement","canMove","move"],created:function(){this.initRemaining(this.movement.remaining)},watch:{movement:function(){this.initRemaining(this.movement.remaining)}}}),z={methods:{isRouteName:function(t){return!_.isEmpty(this.$route)&&this.$route.name===t}}},R={props:["isEnabled","url","canMove","close"],components:{Movement:I},mixins:[z],data:function(){return{data:{incoming_movements:[]}}},created:function(){var t=this;s.$on("user-update",(function(){return t.fetchData()}))},computed:{isEmpty:function(){return!this.data.incoming_movements.length}},watch:{isEnabled:function(){this.fetchData()}},methods:{fetchData:function(){var t=this;this.isEnabled&&axios.get(this.url).then((function(e){t.data=e.data}))},move:function(t){s.$emit("starmap-move",t.end.x,t.end.y),this.close()}}},N={props:["isEnabled","url","storeUrl","close","planets"],components:{Completion:M},mixins:[z],data:function(){return{selected:void 0,data:{can_store:!0,shields:[]}}},computed:{isEmpty:function(){return!this.data.shields.length}},watch:{isEnabled:function(){this.fetchData()},planets:function(){_.find(this.planets,{id:this.selected})||(this.selected=_.get(_.first(this.planets),"id"))}},methods:{fetchData:function(){var t=this;this.isEnabled&&axios.get(this.url).then((function(e){t.data=e.data}))},store:function(){axios.post(this.storeUrl.replace("__planet__",this.selected)).then(this.fetchData)},move:function(t){s.$emit("starmap-move",t.planet.x,t.planet.y),this.close()}}},H=o.extend({props:["url","storeUrl"],components:{Armory:A,Cargo:q,Laboratory:C,Radar:R,Shield:N},mixins:[S],data:function(){return{selected:void 0,selectedTab:"cargo",data:{capital_id:void 0,capital_change_remaining:0,incoming_capital_movement_count:0,planets:[]}}},created:function(){var t=this;s.$on("mothership-click",this.open),s.$on("user-updated",(function(){return t.fetchData()}))},computed:{canHyperjump:function(){return!this.data.incoming_capital_movement_count&&this.selected!==this.data.capital_id}},methods:{open:function(t){t&&this.selectTab(t),this.fetchData(!0)},fetchData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(e||this.isEnabled)&&axios.get(this.url).then((function(i){t.data=i.data,t.selected=t.data.capital_id,t.initRemaining(t.data.capital_change_remaining),e&&t.$nextTick((function(){return t.$modal.modal()}))}))},store:function(){axios.put(this.storeUrl.replace("__planet__",this.selected))}}}),O={data:function(){return{isMove:!1,quantity:{}}},computed:{hasUnits:function(){var t=this,e=_.pickBy(this.quantity),i=!1;return _.forEach(this.planet.units,(function(n){return!_.has(e,n.id)||(i=e[n.id]>0,i&&e[n.id]<=t.unitQuantity(n))})),i},slowestSupportUnitSpeed:function(){if(this.hasUnits){var t=_.pickBy(this.quantity);return _.get(_.minBy(_.filter(this.planet.units,(function(e){return _.has(t,e.id)})),"speed"),"speed",1)}return 1}},methods:{setTotalUnit:function(t){var e=this.unitQuantity(t);e>0&&this.$set(this.quantity,t.id,e)},unitQuantity:function(t){return(this.isMove?_.get(t,"storage",0):0)+_.get(t,"quantity",0)}}},B={data:function(){return{isMove:!1,quantity:{}}},computed:{canTransport:function(){return this.hasResources&&this.transporterQuantity<=this.unitQuantity(this.transporterUnit)},hasResources:function(){var t=this,e=_.pickBy(this.quantity),i=!1;return _.forEach(this.planet.resources,(function(n){return!_.has(e,n.id)||(i=e[n.id]>0,i&&e[n.id]<=t.resourceQuantity(n))})),i},transporterUnit:function(){var t=this;return _.find(this.planet.units,(function(e){return e.type===t.unitTypes.transporter}))},transporterQuantity:function(){if(!this.hasResources)return 0;var t=_.reduce(_.pickBy(this.quantity),(function(t,e){return t+e}),0);return Math.ceil(t/this.transporterUnit.capacity)}},methods:{setTotalResource:function(t){var e=this.resourceQuantity(t);e>0&&this.$set(this.quantity,t.id,e)},resourceQuantity:function(t){var e=this.isMove?_.get(t,"storage",0):0;return this.planet.resource_id===t.id?e+Math.floor(this.mined):e+_.get(t,"quantity",0)}}},F=o.extend({props:["types","unitTypes","urls"],mixins:[O,B],data:function(){return{isMove:!0,type:void 0,mined:0,selected:{id:void 0,travel_time:0},planet:{id:void 0,resource_id:void 0,resources:[],units:[]}}},created:function(){var t=this;s.$on("move-click",this.open),s.$on("planet-updated",(function(e){t.planet=e})),s.$on("resource-updated",(function(e){t.mined=e}))},computed:{isScoutType:function(){return this.type===this.types.scout},isAttackType:function(){return this.type===this.types.attack},isOccupyType:function(){return this.type===this.types.occupy},isSupportType:function(){return this.type===this.types.support},isTransportType:function(){return this.type===this.types.transport},canScout:function(){return _.has(this.quantity,this.scoutUnit.id)&&this.quantity[this.scoutUnit.id]>0&&this.quantity[this.scoutUnit.id]<=this.unitQuantity(this.scoutUnit)},canOccupy:function(){return this.unitQuantity(this.settlerUnit)>0},hasFighterUnits:function(){var t=this,e=_.pickBy(this.quantity),i=!1;return _.forEach(this.fighterUnits,(function(n){return!_.has(e,n.id)||(i=e[n.id]>0,i&&e[n.id]<=t.unitQuantity(n))})),i},scoutUnit:function(){var t=this;return _.find(this.planet.units,(function(e){return e.type===t.unitTypes.scout}))},settlerUnit:function(){var t=this;return _.find(this.planet.units,(function(e){return e.type===t.unitTypes.settler}))},fighterUnits:function(){var t=this;return _.filter(this.planet.units,(function(e){return e.type===t.unitTypes.fighter||e.type===t.unitTypes.heavyFighter}))},travelTime:function(){return Math.round(this.selected.travel_time/this.slowestUnitSpeed)},slowestUnitSpeed:function(){if(this.isScoutType)return this.scoutUnit.speed;if(this.isOccupyType)return this.settlerUnit.speed;if(this.isTransportType)return this.transporterUnit.speed;if(this.isSupportType)return this.slowestSupportUnitSpeed;if(this.isAttackType&&this.hasFighterUnits){var t=_.pickBy(this.quantity);return _.get(_.minBy(_.filter(this.fighterUnits,(function(e){return _.has(t,e.id)})),"speed"),"speed",1)}return 1}},methods:{open:function(t,e){var i=this;this.type=t,this.selected=e,this.quantity={},this.$nextTick((function(){return i.$modal.modal()}))},scout:function(){axios.post(this.urls.scout.replace("__planet__",this.selected.id),{quantity:this.quantity[this.scoutUnit.id]}).then(this.close)},attack:function(){axios.post(this.urls.attack.replace("__planet__",this.selected.id),{quantity:this.quantity}).then(this.close)},occupy:function(){axios.post(this.urls.occupy.replace("__planet__",this.selected.id)).then(this.close)},support:function(){axios.post(this.urls.support.replace("__planet__",this.selected.id),{quantity:this.quantity}).then(this.close)},transport:function(){axios.post(this.urls.transport.replace("__planet__",this.selected.id),{quantity:this.quantity}).then(this.close)}}}),J={methods:{prev:function(){s.$emit("prev-planet")},next:function(){s.$emit("next-planet")},upgradeAll:function(){s.$emit("upgrade-all-open")}}},Q=o.extend({props:["url","planetImageUrl"],data:function(){return{geoJsonPoint:{properties:{status:""},geometry:{coordinates:[]}},planet:{id:void 0},data:{resource_id:null,username:""}}},created:function(){var t=this;s.$on("planet-click",this.open),s.$on("planet-updated",(function(e){t.planet=e}))},computed:{isCurrent:function(){return this.properties.id===this.planet.id},isFriendly:function(){return"friendly"===this.properties.status},properties:function(){return this.geoJsonPoint.properties},geometry:function(){return this.geoJsonPoint.geometry},planetPreviewUrl:function(){return this.data&&this.data.resource_id&&this.planetImageUrl?this.planetImageUrl.replace("__resource__",this.data.resource_id):null}},methods:{open:function(t){this.geoJsonPoint=t,this.fetchData()},fetchData:function(){var t=this;axios.get(this.url.replace("__planet__",this.properties.id)).then((function(e){t.data=e.data,t.$nextTick((function(){return t.$modal.modal()}))}))},openUser:function(){var t=this;this.openAfterHidden((function(){return s.$emit("profile-click",t.data.username)}))},changePlanet:function(){s.$emit("change-planet",this.properties.id)},jumpToSurface:function(){this.$modal.modal("hide"),this.$nextTick((function(){$(".modal-backdrop").remove(),$("body").removeClass("modal-open").css({overflow:"","padding-right":""})})),this.$router.push({name:"home"}).catch((function(t){t&&"NavigationDuplicated"===t.name||(window.location.href="/")}))},openMove:function(t){var e=this;this.openAfterHidden((function(){return s.$emit("move-click",t,_.assignIn({},e.properties,e.data))}))}}}),Z={props:["url"],data:function(){return{isSubscribed:!1,energy:0,energyInterval:void 0,data:{id:void 0,username:"",production_rate:0,experience:0,level:1,level_experience:0,next_level_experience:0,notification_count:0}}},created:function(){this.fetchData()},computed:{hasUnread:function(){return this.data.notification_count>0},experienceLabel:function(){return"".concat(this.data.experience," / ").concat(this.data.next_level_experience)},experienceProgress:function(){return"".concat((this.data.experience-this.data.level_experience)/(this.data.next_level_experience-this.data.level_experience)*100,"%")},energyValue:function(){return Math.round(this.energy)}},watch:{energy:function(){s.$emit("energy-updated",this.energy)}},methods:{fetchData:function(){var t=this;s.$emit("user-update"),this.unsubscribe(),axios.get(this.url).then((function(e){t.data=e.data,t.initEnergy(),t.subscribe(),s.$emit("user-updated",t.data)}))},initEnergy:function(){var t=this;this.clearEnergy(),this.energy=this.data.energy,this.data.production_rate&&(this.energyInterval=setInterval((function(){t.energy+=t.data.production_rate/3600}),1e3))},clearEnergy:function(){this.energyInterval&&(this.energyInterval=clearInterval(this.energyInterval))},subscribe:function(){this.isSubscribed||(Echo.private("user.".concat(this.data.id)).listen(".updated",this.fetchData).notification(this.fetchData),this.isSubscribed=!0)},unsubscribe:function(){this.isSubscribed&&(Echo.leave("user.".concat(this.data.id)),this.isSubscribed=!1)},openUser:function(){s.$emit("profile-click",this.data.username)},openMailbox:function(){s.$emit("mailbox-click")},openSetting:function(){s.$emit("setting-click")}}};const Y={bind:function(t,e){var i={container:"body"};e.value&&(i=_.extend({},i,e.value)),$(t).popover(i)},unbind:function(t){$(t).popover("dispose")},update:function(t,e){e.value.title!==e.oldValue.title&&($(t).data("bs.popover").config.title=e.value.title),e.value.content!==e.oldValue.content&&($(t).data("bs.popover").config.content=e.value.content)}},W=k.extend({props:["username","canMove","close"],computed:{dataUrl:function(){return this.url.replace("__user__",this.username)}},methods:{move:function(t){s.$emit("starmap-move",t.x,t.y),this.close()}}}),X=o.extend({props:["url","blockUrl","canMove","translations"],components:{PlanetList:W},mixins:[z],data:function(){return{isBlocked:!1,username:"",data:{is_blocked:!1,created_at:""}}},created:function(){s.$on("profile-click",this.open)},computed:{joined:function(){return this.translations.joined.replace("__datetime__",g(this.data.created_at))}},methods:{open:function(t){this.username=t,this.fetchData()},fetchData:function(){var t=this;axios.get(this.url.replace("__user__",this.username)).then((function(e){t.data=e.data,t.isBlocked=t.data.is_blocked,t.$nextTick((function(){return t.$modal.modal()}))}))},sendMessage:function(){var t=this;this.openAfterHidden((function(){return s.$emit("message-click",t.username)}))},toggleBlock:function(){this.isBlocked=!this.isBlocked,axios.put(this.blockUrl.replace("__user__",this.username))}}}),V=P.extend({props:["settings"],computed:{method:function(){return"put"}},methods:{values:function(){return{title:this.settings.title,description:this.settings.description,author:this.settings.author}},handleSuccess:function(){window.location.reload()}}}),K=P.extend({components:{DeveloperSetting:V},mixins:[S],data:function(){return{selectedTab:"profile",user:{email:"",is_notification_enabled:!0}}},created:function(){var t=this;s.$on("setting-click",this.open),s.$on("user-updated",(function(e){t.user=e}))},computed:{method:function(){return"put"}},methods:{open:function(){var t=this;this.form=this.values(),this.$nextTick((function(){return t.$modal.modal()}))},values:function(){return{email:this.user.email,password:"",password_confirmation:"",is_notification_enabled:this.user.is_notification_enabled}}}});var G=i(4772);const tt={props:["planetUrl","planetNameUrl","userCurrentUrl"],mixins:[z],data:function(){return{perfectScrollbar:void 0,isActive:!1,isEditActive:!1,isSubscribed:!1,selected:void 0,name:"",usedCapacity:0,resource:0,resourceInterval:void 0,data:{id:void 0,resource_id:void 0,user_id:void 0,capacity:0,supply:0,solarion:0,mining_rate:0,used_capacity:0,used_supply:0,used_training_supply:0,display_name:"",planets:[],resources:[],units:[]}}},created:function(){var t=this;this.fetchData(),s.$on("prev-planet",this.prevPlanet),s.$on("next-planet",this.nextPlanet),s.$on("change-planet",(function(e){t.selected=e})),s.$on("planet-data-request",(function(){t.data&&t.data.id&&(s.$emit("planet-updated",t.data),s._lastPlanetData=t.data)}))},mounted:function(){this.initPerfectScrollbar()},watch:{$route:function(){this.fetchData()},selected:function(){this.changePlanet()},resource:function(){s.$emit("resource-updated",this.resource)}},computed:{isResourceFull:function(){return this.data.capacity===this.usedCapacity},isUnitFull:function(){return this.data.supply===this.data.used_supply},selectedIndex:function(){return _.findIndex(this.data.planets,{id:this.selected})},resourceLabel:function(){return"".concat(Math.round(this.usedCapacity)," / ").concat(this.data.capacity)},resourceProgress:function(){return"".concat(Math.min(100,this.usedCapacity/this.data.capacity*100),"%")},unitLabel:function(){return"".concat(this.data.used_supply+this.data.used_training_supply," / ").concat(this.data.supply)},unitProgress:function(){return"".concat(this.data.used_supply/this.data.supply*100,"%")},unitTrainingProgress:function(){return"".concat(this.data.used_training_supply/this.data.supply*100,"%")}},methods:{fetchData:function(){var t=this;s.$emit("planet-update"),this.unsubscribe(),axios.get(this.planetUrl).then((function(e){t.data=e.data,t.selected=t.data.id,t.initName(),t.initResource(),t.subscribe(),s.$emit("planet-updated",t.data),s._lastPlanetData=t.data}))},renamePlanet:function(){this.name===this.data.display_name?this.isEditActive=!1:this.name||this.data.name!==this.data.display_name?axios.put(this.planetNameUrl,{name:this.name}):this.initName()},prevPlanet:function(){var t=this.selectedIndex-1;t<0&&(t=this.data.planets.length-1),this.changePlanetByIndex(t)},nextPlanet:function(){var t=this.selectedIndex+1;t===this.data.planets.length&&(t=0),this.changePlanetByIndex(t)},changePlanet:function(){this.selected!==this.data.id&&axios.put(this.userCurrentUrl.replace("__planet__",this.selected))},changePlanetByIndex:function(t){_.isUndefined(this.data.planets[t])||(this.selected=_.get(this.data.planets[t],"id"))},initName:function(){this.isEditActive=!1,this.name=this.data.display_name},initResource:function(){var t=this;this.clearResource(),this.usedCapacity=this.data.used_capacity,this.resource=_.get(_.find(this.data.resources,{id:this.data.resource_id}),"quantity",0),this.data.mining_rate&&this.data.capacity!==this.usedCapacity&&(this.resourceInterval=setInterval((function(){var e=Math.min(t.data.capacity-t.usedCapacity,t.data.mining_rate/3600);t.resource+=e,t.usedCapacity+=e,t.data.capacity===t.usedCapacity&&t.clearResource()}),1e3))},clearResource:function(){this.resourceInterval&&(this.resourceInterval=clearInterval(this.resourceInterval))},initPerfectScrollbar:function(){this.perfectScrollbar=new G.default(this.$refs.scrollbar)},updatePerfectScrollbar:function(){this.perfectScrollbar.update()},subscribe:function(){this.isSubscribed||(Echo.private("planet.".concat(this.data.id)).listen(".updated",this.fetchData),s.$on("user-update",this.fetchData),this.isSubscribed=!0)},unsubscribe:function(){this.isSubscribed&&(Echo.leave("planet.".concat(this.data.id)),s.$off("user-update",this.fetchData),this.isSubscribed=!1)},toggle:function(){this.isActive=!this.isActive,this.isActive&&this.updatePerfectScrollbar()},toggleEdit:function(){var t=this;this.isEditActive=!this.isEditActive,this.isEditActive&&this.$nextTick((function(){return t.$refs.name.focus()}))},resourceQuantity:function(t){return t.id===this.data.resource_id?this.resource:t.quantity},resourceValue:function(t){return Math.round(this.resourceQuantity(t))},openMothership:function(){s.$emit("mothership-click")},openTrophy:function(){s.$emit("trophy-click")}}},et=o.extend({props:["url","bookmarkStoreUrl"],data:function(){return{geoJsonPoint:{properties:{},geometry:{coordinates:[]}},data:{is_bookmarked:!1,has_expedition:!1}}},created:function(){s.$on("star-click",this.open)},computed:{properties:function(){return this.geoJsonPoint.properties},geometry:function(){return this.geoJsonPoint.geometry}},methods:{open:function(t){this.geoJsonPoint=t,this.fetchData()},fetchData:function(){var t=this;axios.get(this.url.replace("__star__",this.properties.id)).then((function(e){t.data=e.data,t.$nextTick((function(){return t.$modal.modal()}))}))},bookmark:function(){this.data.is_bookmarked=!0,axios.post(this.bookmarkStoreUrl.replace("__star__",this.properties.id))},showExpedition:function(){this.openAfterHidden((function(){return s.$emit("mothership-click","armory")}))}}});const it={props:{size:{type:Number,required:!0},maxZoom:{type:Number,required:!0},geoJsonUrl:{type:String,required:!0},tileUrl:{type:String,required:!0},imagePath:{type:String,required:!0},zoomInTitle:{type:String,required:!0},zoomOutTitle:{type:String,required:!0},bookmarkTitle:{type:String,required:!0}},data:function(){return{geoJsonLayer:void 0,map:void 0,zoom:0,planet:{id:void 0,x:0,y:0}}},created:function(){this.zoom=Math.ceil(Math.log(this.size/256)/Math.log(2))},mounted:function(){var t=this;s.$on("planet-updated",this.planetUpdated),s.$on("starmap-move",this.starmapMove),this.$nextTick((function(){t.map&&t.map.invalidateSize(!0)}))},beforeDestroy:function(){s.$off("planet-updated",this.planetUpdated),s.$off("starmap-move",this.starmapMove),this.destoryLeaflet()},methods:{planetUpdated:function(t){var e=t.id===this.planet.id;this.planet=t,this.map?e?this.geoJsonLayer.refresh():this.map.setView(this.center(),this.maxZoom):this.initLeaflet()},starmapMove:function(t,e){this.map.setView(this.unproject(t,e),this.maxZoom)},initLeaflet:function(){var t=this;L.Icon.Default.imagePath="".concat(this.imagePath,"/"),this.map=L.map(this.$el,{attributionControl:!1,boxZoom:!1,crs:L.CRS.Simple,minZoom:0,maxZoom:this.maxZoom,zoomControl:!1}),this.map.setView(this.center(),this.maxZoom),L.tileLayer(this.tileUrl,{noWrap:!0,bounds:L.latLngBounds(this.southWest(),this.northEast())}).addTo(this.map);var e=function(e){return t.map.unproject([e[0],e[1]],t.maxZoom)};this.geoJsonLayer=L.geoJson.ajax(this.geoJson(),{coordsToLatLng:e,pointToLayer:function(i,n){return i.properties.is_movement?t.movementMarker(n,e(i.properties.end),i):t.objectMarker(n,i)},style:function(e){return"LineString"===e.geometry.type?{className:"leaflet-movement ".concat(t.movementClassName(e))}:{}}}),this.geoJsonLayer.ajaxParams.headers=axios.defaults.headers.common,this.geoJsonLayer.addTo(this.map),this.map.on("zoomstart",(function(){return t.geoJsonLayer.clearLayers()})),this.map.on("moveend",(function(){return t.geoJsonLayer.refresh(t.geoJson())})),this.zoomControl().addTo(this.map),this.bookmarkControl().addTo(this.map),window.__starmap=this.map,this.$nextTick((function(){requestAnimationFrame((function(){t.map.invalidateSize(!0)}))}))},destoryLeaflet:function(){this.map&&(this.map.remove(),this.map=void 0,window.__starmap=void 0)},geoJson:function(){var t=this.map.getPixelBounds(),e=this.multiplier();return this.geoJsonUrl.replace("__zoom__",this.map.getZoom()).replace("__bounds__",[t.min.x*e,t.min.y*e,t.max.x*e,t.max.y*e].join(","))},center:function(){return this.unproject(this.planet.x,this.planet.y)},southWest:function(){return this.unproject(0,0)},northEast:function(){return this.unproject(this.size,this.size)},unproject:function(t,e){return this.map.unproject([t,e],this.zoom)},multiplier:function(){return Math.pow(2,this.maxZoom-this.map.getZoom())},zoomControl:function(){return L.control.zoom({zoomInTitle:this.zoomInTitle,zoomOutTitle:this.zoomOutTitle})},bookmarkControl:function(){return new(L.Control.extend({options:{position:"topleft",bookmarkTitle:this.bookmarkTitle,bookmarkIconClass:"fas fa-star"},onAdd:function(){var t=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-bookmark"),e=L.DomUtil.create("a","leaflet-control-bookmark",t);return e.href="#",e.title=this.options.bookmarkTitle,e.onclick=function(t){t.preventDefault(),s.$emit("bookmark-click")},L.DomUtil.create("i",this.options.bookmarkIconClass,e),t}}))},objectMarker:function(t,e){var i=(e.properties.size+16)/this.multiplier(),n=e.properties,r="leaflet-icon-object";"planet"===n.type?r+=" leaflet-planet leaflet-planet-".concat(n.resource_id||1," ").concat(n.status):"star"===n.type&&(r+=" leaflet-star");var a={className:r,iconSize:[i,i]};this.map.getZoom()>=8&&(a.html="<span>".concat(n.name,"</span>"));var o=L.marker(t,{title:e.properties.name,icon:L.divIcon(a)});return o.on("click",(function(){return s.$emit("".concat(e.properties.type,"-click"),e)})),o},movementMarker:function(t,e,i){L.MovementMarker=L.Marker.extend({options:{end:e,interval:i.properties.interval},onAdd:function(t){var e=this;L.Marker.prototype.onAdd.call(this,t),this._icon&&(this._icon.style[L.DomUtil.TRANSITION]="all ".concat(this.options.interval-1,"s linear")),this._shadow&&(this._shadow.style[L.DomUtil.TRANSITION]="all ".concat(this.options.interval-1,"s linear")),setTimeout((function(){return e.setLatLng(e.options.end)}),1e3)}});var n=32/this.multiplier(),r={className:"leaflet-icon-movement ".concat(this.movementClassName(i)," size-").concat(n),iconSize:[n,n]};if(this.map.getZoom()>=8){var s=Math.atan2(e.lng-t.lng,e.lat-t.lat),a=360*(s>0?s:2*Math.PI+s)/(2*Math.PI)-45;r.html='<i class="fas fa-rocket" style="'.concat(L.DomUtil.TRANSFORM,": translateX(-50%) translateY(-50%) rotate(").concat(a,'deg)"></i>')}return new L.MovementMarker(t,{icon:L.divIcon(r)})},movementClassName:function(t){return"expedition"===t.properties.type?t.properties.type:t.properties.type<3?"".concat(t.properties.status,"-attack"):t.properties.status}}};var nt=i(1900);const rt=(0,nt.Z)(it,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"starmap"})}),[],!1,null,null,null).exports;var st=i(3832);const at={hitArea:new st.mg([0,120,160,40,320,120,160,200]),plain:new st.Ae(0,0,320,200),resources:{1:new st.Ae(320,0,320,200),2:new st.Ae(640,0,320,200),3:new st.Ae(960,0,320,200),4:new st.Ae(1280,0,320,200),5:new st.Ae(1600,0,320,200),6:new st.Ae(0,200,320,200),7:new st.Ae(320,200,320,200)},buildings:{1:new st.Ae(640,200,320,200),2:{1:new st.Ae(960,200,320,200),2:new st.Ae(1280,200,320,200),3:new st.Ae(1600,200,320,200),4:new st.Ae(0,400,320,200),5:new st.Ae(320,400,320,200),6:new st.Ae(640,400,320,200),7:new st.Ae(960,400,320,200)},3:new st.Ae(1280,400,320,200),4:new st.Ae(1600,400,320,200),5:new st.Ae(0,600,320,200),6:new st.Ae(320,600,320,200),7:new st.Ae(640,600,320,200),8:new st.Ae(960,600,320,200),9:new st.Ae(1280,600,320,200),10:new st.Ae(1600,600,320,200)},constructions:{1:new st.Ae(0,800,320,200),2:new st.Ae(320,800,320,200),3:new st.Ae(640,800,320,200),4:new st.Ae(960,800,320,200),5:new st.Ae(1280,800,320,200),6:new st.Ae(1600,800,320,200),7:new st.Ae(0,1e3,320,200),8:new st.Ae(320,1e3,320,200),9:new st.Ae(640,1e3,320,200),10:new st.Ae(960,1e3,320,200)}};function ot(t){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}const ct={props:{width:{type:Number,required:!0},height:{type:Number,required:!0},backgroundTexture:{type:String,required:!0},gridTextureAtlas:{type:String,required:!0}},data:function(){return{$viewport:void 0,animationFrame:void 0,clickTreshold:5,isDragging:!1,dragStartX:0,dragStartY:0,dragged:0,container:void 0,intervals:[],loader:void 0,renderer:void 0,stage:void 0,ready:!1,retryCount:0,maxRetries:3,errorMessage:"",breakpoints:[{minWidth:1,maxHeight:592,ratio:.64},{minWidth:992,maxHeight:765,ratio:.827},{minWidth:1200,maxHeight:!1,ratio:1}],planet:{resource_id:void 0,grids:[]},textStyle:{fontFamily:"Exo 2",fontSize:"14px",fill:"#fff",align:"center",stroke:"#0e141c",strokeThickness:4}}},created:function(){st.P6.skipHello()},mounted:function(){var t=this;this._destroyed=!1,this.$viewport=$(this.$el),s.$on("planet-updated",this.planetUpdated),s.$emit("planet-data-request"),this._apiTimer=setTimeout((function(){t._destroyed||t.stage||t._loading||t.fetchPlanetDirect()}),1500),this._retryTimer=setTimeout((function(){t._destroyed||t.stage||t._loading||s.$emit("planet-data-request")}),4e3)},beforeDestroy:function(){this._destroyed=!0,s.$off("planet-updated",this.planetUpdated),this._apiTimer&&(clearTimeout(this._apiTimer),this._apiTimer=void 0),this._retryTimer&&(clearTimeout(this._retryTimer),this._retryTimer=void 0),this._loadTimeout&&(clearTimeout(this._loadTimeout),this._loadTimeout=void 0),this.destroyPixi()},methods:{toLocalPath:function(t){if(!t)return t;try{var e=new URL(t,window.location.origin);return e.pathname+e.search}catch(e){return t.replace(/^https?:\/\/[^/]+/,"")}},applyCssBackground:function(){if(this.planet.resource_id&&this.$refs.viewport){var t=this.toLocalPath(this.background()),e=this.$refs.viewport;e.style.backgroundImage="url(".concat(t,")"),e.style.backgroundSize="cover",e.style.backgroundPosition="center"}},fetchPlanetDirect:function(){var t=this;axios.get("/api/planet").then((function(e){!t._destroyed&&e.data&&e.data.id&&t.planetUpdated(e.data)})).catch((function(e){console.error("[Surface] Direct API fetch failed:",e),t._destroyed||t.stage||(t.errorMessage="Failed to load planet data. Please reload.")}))},planetUpdated:function(t){this._destroyed||(this.planet=t,this.applyCssBackground(),this.stage||this._loading?this.stage&&this.updatePixi():(this.$viewport=$(this.$el),this.initPixi()))},initPixi:function(){var t=this;if(!this._destroyed){this._loading=!0,this.errorMessage="",this.loader=new st.aN,this.loader.onError.add((function(t,e,i){console.error("[Surface] Loader error for",i.url,t)}));var e=this.toLocalPath(this.background()),i=this.toLocalPath(this.gridTextureAtlas);this.loader.add({name:this.backgroundName(),url:e,crossOrigin:""}),this.loader.add({name:"grid",url:i,crossOrigin:""}),this._loadTimeout=setTimeout((function(){t._loading&&!t._destroyed&&(console.error("[Surface] Texture loading timed out — retrying."),t.destroyPixi(),t.retryInit())}),15e3),this.loader.load((function(){if(t._loadTimeout&&(clearTimeout(t._loadTimeout),t._loadTimeout=void 0),t._loading=!1,!t._destroyed){var e=t.loader.resources[t.backgroundName()],i=t.loader.resources.grid;if(!e||e.error||!i||i.error)return console.error("[Surface] Critical texture(s) failed to load —","bg:",e?e.error||"ok":"missing","grid:",i?i.error||"ok":"missing"),t.destroyPixi(),void t.retryInit();var n=e.texture,r=i.texture;if(!n||n.width<1||n.height<1)return console.error("[Surface] Background texture has no dimensions:",n?"".concat(n.width,"×").concat(n.height):"null"),t.destroyPixi(),void t.retryInit();if(!r||r.width<1||r.height<1)return console.error("[Surface] Grid texture has no dimensions:",r?"".concat(r.width,"×").concat(r.height):"null"),t.destroyPixi(),void t.retryInit();try{t.setup(),t.align(),t.animate(),t.ready=!0}catch(e){console.error("[Surface] Render setup error:",e),t.ready=!0,t.errorMessage="Surface render error. Please reload."}}})),this.stage=new st.W2,this.container=new st.W2,this.container.interactive=!0,this.container.scale.set(this.containerScale()),this.container.on("mousedown",this.mouseDown),this.container.on("mousemove",this.mouseMove),this.container.on("mouseup",this.mouseUp),this.container.on("mouseupoutside",this.mouseUp),this.container.on("touchstart",this.mouseDown),this.container.on("touchmove",this.mouseMove),this.container.on("touchend",this.mouseUp),this.container.on("touchendoutside",this.mouseUp),this.stage.addChild(this.container);try{this.renderer=(0,st.e6)({height:this.rendererHeight(),backgroundColor:724500,view:this.$refs.canvas,width:this.rendererWidth()})}catch(t){return console.error("[Surface] Failed to create PixiJS renderer:",t),this.destroyPixi(),void this.retryInit()}window.addEventListener("resize",this.resize)}},retryInit:function(){var t=this;if(this.retryCount+=1,this.retryCount>this.maxRetries)return console.error("[Surface] Max retries reached (".concat(this.maxRetries,").")),this.ready=!0,void(this.errorMessage="Surface could not be loaded. Please reload the page.");var e=Math.min(1e3*Math.pow(2,this.retryCount-1),8e3);setTimeout((function(){t._destroyed||t.stage||t._loading||!t.planet.resource_id||t.initPixi()}),e)},updatePixi:function(){var t=this;if(!this._loading){if(!this.loader||!this.loader.resources.grid||this.loader.resources.grid.error)return this.destroyPixi(),void this.initPixi();var e=this.backgroundName(),i=function(){try{t.setup()}catch(t){console.error("[Surface] updatePixi setup error:",t)}};if(this.loader.resources[e])i();else{this._loading=!0;var n=this.toLocalPath(this.background());this.loader.add({name:e,url:n,crossOrigin:""}),this.loader.load((function(){t._loading=!1,t._destroyed||i()}))}}},destroyPixi:function(){this._loading=!1,this.clearIntervals(),this._loadTimeout&&(clearTimeout(this._loadTimeout),this._loadTimeout=void 0),this.animationFrame&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0),this.renderer&&(this.renderer.destroy(),this.renderer=void 0),this.container&&(this.container.destroy(!0,!0,!0),this.container=void 0),this.stage&&(this.stage.destroy(!0,!0,!0),this.stage=void 0),this.loader&&(this.loader.destroy(),this.loader=void 0),st.P6.destroyTextureCache(),window.removeEventListener("resize",this.resize)},setup:function(){var t=this;this.clearIntervals(),this.container.removeChildren(),this.container.addChild(this.backgroundSprite()),_.forEach(this.planet.grids,(function(e){return t.container.addChild(t.gridSprite(e))}))},clearIntervals:function(){_.forEach(this.intervals,(function(t){return clearInterval(t)})),this.intervals=[]},resize:function(){this.renderer&&(this.renderer.resize(this.rendererWidth(),this.rendererHeight()),this.container.scale.set(this.containerScale()),this.align())},align:function(){this.container.position.x=this.centerX(),this.container.position.y=this.centerY()},animate:function(){if(!this._destroyed&&this.renderer&&this.stage&&this.container){this.animationFrame=requestAnimationFrame(this.animate);var t=this.containerX(),e=this.containerY();this.container.position.x<t&&(this.container.position.x=t),this.container.position.y<e&&(this.container.position.y=e),this.container.position.x>0&&(this.container.position.x=0),this.container.position.y>0&&(this.container.position.y=0),this.renderer.render(this.stage)}},mouseDown:function(t){var e=t.data.getLocalPosition(this.container.parent);this.dragStartX=e.x-this.container.position.x,this.dragStartY=e.y-this.container.position.y,this.isDragging=!0,this.dragged=0},mouseMove:function(t){if(this.isDragging){var e=t.data.getLocalPosition(this.container.parent),i=this.container.position.x,n=this.container.position.y;this.container.position.x=e.x-this.dragStartX,this.container.position.y=e.y-this.dragStartY,this.dragged+=Math.abs(i-this.container.position.x),this.dragged+=Math.abs(n-this.container.position.y)}},mouseUp:function(){this.isDragging=!1},background:function(){return this.backgroundTexture.replace("__resource__",this.planet.resource_id)},backgroundName:function(){return"background_".concat(this.planet.resource_id)},backgroundSprite:function(){return new st.jy(this.loader.resources[this.backgroundName()].texture)},rendererWidth:function(){var t=this.$viewport?this.$viewport.width():0;return t>1?t:this.width},rendererHeight:function(){var t=this.$viewport?this.$viewport.height():0;return t>1?t:this.height},centerX:function(){return this.containerX()/2},centerY:function(){return this.containerY()/2},containerX:function(){return this.renderer.width-this.container.width},containerY:function(){return this.renderer.height-this.container.height},containerScale:function(){var t=this.rendererWidth(),e=this.rendererHeight(),i=_.findLast(this.breakpoints,(function(e){return e.minWidth<=t}));return i?!1===i.maxHeight||i.maxHeight>=e?i.ratio:(i=_.findLast(this.breakpoints,(function(t){return t.maxHeight>=e})),_.isUndefined(i)?1:i.ratio):1},gridSprite:function(t){var e=this,i=new st.jy(this.gridTexture(t));return i.interactive=!0,i.hitArea=at.hitArea,i.x=this.gridX(t),i.y=this.gridY(t),i.on("mouseover",(function(){return e.gridOver(i)})),i.on("mouseout",(function(){return e.gridOut(i)})),i.on("click",(function(){return e.gridClick(t)})),i.on("tap",(function(){return e.gridClick(t)})),this.gridLevel(t,i),this.gridRemaining(t,i),i},gridTexture:function(t){var e=at.plain;try{if(t.construction)e=at.constructions[t.construction.building_id]||at.plain;else if(1===t.type)if(t.building_id){var i=at.buildings[t.building_id];e=i&&"object"===ot(i)&&!i.width?i[this.planet.resource_id]||at.plain:i||at.plain}else e=at.resources[this.planet.resource_id]||at.plain;else t.building_id&&(e=at.buildings[t.building_id]||at.plain)}catch(i){console.warn("[Surface] gridTexture fallback for grid",t.id,i.message),e=at.plain}return new st.xE(this.loader.resources.grid.texture,e)},gridX:function(t){return 162*(t.x-t.y+4)+(this.width-1608)/2},gridY:function(t){return 81*(t.x+t.y)+(this.height-888)/2},gridOver:function(t){t.alpha=.6},gridOut:function(t){t.alpha=1},gridClick:function(t){this.dragged>this.clickTreshold||s.$emit(t.building_id?"building-click":"grid-click",t)},gridLevel:function(t,e){if(t.level){var i=new st.xv(t.level,this.textStyle);i.position.x=(e.width-i.width)/2,i.position.y=e.height-50,e.addChild(i)}},gridRemaining:function(t,e){var i,n;if(t.construction?(i=t.construction.remaining,n=this.textStyle):t.training?(i=t.training.remaining,n=_.assignIn({},this.textStyle,{fill:"#ebb237"})):t.upgrade&&(i=t.upgrade.remaining,n=this.textStyle),i){var r=new st.xv(w(i),n);r.position.x=(e.width-r.width)/2,r.position.y=(e.height-r.height)/2,e.addChild(r);var s=setInterval((function(){i-=1,r.text=w(i),i||clearInterval(s)}),1e3);this.intervals.push(s)}}}};const ut=(0,nt.Z)(ct,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"viewport",staticClass:"surface-viewport"},[i("canvas",{ref:"canvas",staticClass:"surface"}),t._v(" "),t.ready?t._e():i("div",{staticClass:"surface-loading"},[i("div",{staticClass:"surface-spinner"}),t._v(" "),t.errorMessage?i("p",{staticClass:"surface-error-text"},[t._v("\n            "+t._s(t.errorMessage)+"\n        ")]):t._e()])])}),[],!1,null,null,null).exports,dt=k.extend({props:["openAfterHidden"],methods:{openUser:function(t){this.openAfterHidden((function(){return s.$emit("profile-click",t)}))},rank:function(t){return this.data.from+t}}}),ht=o.extend({components:{Leaderboard:dt},mixins:[S],data:function(){return{selectedTab:"pve"}},created:function(){s.$on("trophy-click",this.open)},methods:{open:function(){var t=this;this.$nextTick((function(){return t.$modal.modal()}))}}}),lt=a.extend({props:["type","building"],data:function(){return{isEnabled:!1}},created:function(){var t=this;s.$on("modal-show",(function(){t.isEnabled=t.type===t.building.type})),s.$on("modal-hidden",(function(){t.isEnabled=!1}))}}),pt=lt.extend({props:["grid","url","storeUrl"],data:function(){return{isResearch:!1,mined:0,quantity:"",planet:{resource_id:void 0,resources:[]},selected:{id:void 0,efficiency:0},data:{resources:[]}}},created:function(){var t=this;s.$on("resource-updated",(function(e){t.mined=e})),s.$on("planet-update",(function(){return t.fetchData()})),s.$on("planet-updated",(function(e){t.planet=e}))},computed:{isTransmutable:function(){return this.quantity>0&&this.quantity<=this.transmutableQuantity},transmutableQuantity:function(){var t=_.find(this.planet.resources,{id:this.selected.id}),e=_.get(t,"storage",0);return this.planet.resource_id===this.selected.id?e+Math.floor(this.mined):e+_.get(t,"quantity",0)},transmutableEnergy:function(){return this.isTransmutable?this.quantity*this.selected.efficiency:0}},watch:{isEnabled:function(){this.fetchData()}},methods:{fetchData:function(){var t=this;this.isEnabled&&axios.get(this.url.replace("__grid__",this.grid.id)).then((function(e){t.data=e.data,_.find(t.data.resources,t.selected)?t.quantity="":t.select(_.first(t.data.resources))}))},store:function(){axios.post(this.storeUrl.replace("__grid__",this.grid.id).replace("__resource__",this.selected.id),{quantity:this.quantity})},isSelected:function(t){return this.selected.id===t.id},select:function(t){this.selected=t,this.quantity=""}}}),ft=lt.extend({props:["grid","url"],components:{Movement:I},data:function(){return{data:{incoming_movements:[],outgoing_movements:[]}}},created:function(){var t=this;s.$on("planet-update",(function(){return t.fetchData()}))},computed:{isEmpty:function(){return!this.data.incoming_movements.length&&!this.data.outgoing_movements.length}},watch:{isEnabled:function(){this.fetchData()}},methods:{fetchData:function(){var t=this;this.isEnabled&&axios.get(this.url.replace("__grid__",this.grid.id)).then((function(e){t.data=e.data}))}}}),mt={props:["isEnabled","building","grid","close","planet","data","storeUrl"],mixins:[O],watch:{isEnabled:function(){this.quantity={}}},computed:{travelTime:function(){return Math.round(this.data.travel_time/this.slowestSupportUnitSpeed*(1-this.building.trade_time_bonus))}},methods:{support:function(){axios.post(this.storeUrl.replace("__grid__",this.grid.id),{quantity:this.quantity}).then(this.close)}}},gt={props:["isEnabled","building","grid","close","mined","planet","data","storeUrl","unitTypes"],mixins:[B],watch:{isEnabled:function(){this.quantity={}}},computed:{travelTime:function(){return Math.round(this.data.travel_time/this.transporterUnit.speed*(1-this.building.trade_time_bonus))}},methods:{transport:function(){axios.post(this.storeUrl.replace("__grid__",this.grid.id),{quantity:this.quantity}).then(this.close)},unitQuantity:function(t){return _.get(t,"storage",0)+_.get(t,"quantity",0)}}},yt=lt.extend({props:["grid","close","url"],components:{Patrol:mt,Trade:gt},mixins:[S],data:function(){return{selectedTab:"trade",mined:0,planet:{id:void 0,resource_id:void 0,resources:[],units:[]},data:{travel_time:0}}},created:function(){var t=this;s.$on("planet-updated",(function(e){t.planet=e})),s.$on("resource-updated",(function(e){t.mined=e}))},watch:{isEnabled:function(){this.fetchData()}},methods:{fetchData:function(){var t=this;this.isEnabled&&axios.get(this.url).then((function(e){t.data=e.data}))}}}),_t=lt.extend({props:["grid","url","storeUrl","destroyUrl"],data:function(){return{isResearch:!1,energy:0,supply:0,quantity:"",selected:{id:void 0,supply:0,train_cost:0,train_time:0},data:{remaining:0,units:[]}}},created:function(){var t=this;s.$on("energy-updated",(function(e){t.energy=e})),s.$on("planet-update",(function(){return t.fetchData()})),s.$on("planet-updated",(function(e){t.supply=e.supply-e.used_supply-e.used_training_supply}))},computed:{isTrainable:function(){return this.quantity>0&&this.quantity<=this.trainableQuantity},trainableQuantity:function(){return Math.floor(Math.min(this.energy/this.selected.train_cost,this.supply/this.selected.supply))},trainName:function(){return"".concat(this.data.quantity," x ").concat(this.selected.name)},trainTime:function(){return this.isTrainable?this.quantity*this.selected.train_time:0}},watch:{isEnabled:function(){this.fetchData()}},methods:{fetchData:function(){var t=this;this.isEnabled&&axios.get(this.url.replace("__grid__",this.grid.id)).then((function(e){t.data=e.data,t.initRemaining(t.data.remaining),_.find(t.data.units,t.selected)?t.quantity="":t.select(_.first(t.data.units))}))},store:function(){axios.post(this.storeUrl.replace("__grid__",this.grid.id).replace("__unit__",this.selected.id),{quantity:this.quantity})},destroy:function(){axios.delete(this.destroyUrl.replace("__grid__",this.grid.id))},isSelected:function(t){return this.selected.id===t.id},select:function(t){this.selected=t,this.quantity=""}}}),vt=o.extend({props:["centralType","url","storeUrl","destroyUrl"],components:{Producer:pt,Scout:ft,Trader:yt,Trainer:_t},data:function(){return{isCapitalPlanet:!1,energy:0,grid:{id:void 0,building_id:void 0},data:{has_training:!1,remaining:0,building:{},upgrade:{}}}},created:function(){var t=this;s.$on("building-click",this.open),s.$on("energy-updated",(function(e){t.energy=e})),s.$on("planet-update",(function(){return t.fetchData()})),s.$on("planet-updated",(function(e){t.isCapitalPlanet=e.is_capital}))},computed:{canConstruct:function(){return this.energy>=this.data.upgrade.construction_cost},canDemolish:function(){return!(this.data.has_training||this.remaining||this.isCapitalPlanet&&this.data.building.type===this.centralType)},building:function(){return this.data.building}},methods:{open:function(t){this.grid=t,this.fetchData(!0)},openDemolish:function(){var t=this;this.openAfterHidden((function(){return s.$emit("demolish-open",t.grid)}))},fetchData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(e||this.isEnabled)&&axios.get(this.url.replace("__grid__",this.grid.id)).then((function(i){t.data=i.data,t.initRemaining(t.data.remaining),e&&t.$nextTick((function(){return t.$modal.modal()}))}))},store:function(){axios.post(this.storeUrl.replace("__grid__",this.grid.id))},destroy:function(){axios.delete(this.destroyUrl.replace("__grid__",this.grid.id))}}}),bt=o.extend({props:["url","storeUrl"],data:function(){return{energy:0,data:{has_solarion:!0,upgrade_count:0,upgrade_cost:0}}},created:function(){var t=this;s.$on("upgrade-all-open",this.open),s.$on("energy-updated",(function(e){t.energy=e}))},computed:{canStore:function(){return this.data.has_solarion&&this.data.upgrade_cost&&this.energy>=this.data.upgrade_cost}},methods:{open:function(){this.fetchData(!0)},fetchData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(e||this.isEnabled)&&axios.get(this.url).then((function(i){t.data=i.data,e&&t.$nextTick((function(){return t.$modal.modal()}))}))},store:function(){axios.post(this.storeUrl).then(this.close)}}});i(9147),n.default.filter("bracket",m),n.default.filter("fromNow",g),n.default.filter("item",y),n.default.filter("number",v),n.default.filter("percent",b),n.default.filter("sign",x),n.default.filter("timer",w),n.default.directive("popover",Y),n.default.use(r.Z);var xt=new r.Z({mode:"history",routes:[{path:"/starmap",name:"starmap",component:rt,props:!0},{path:"/",name:"home",component:ut,props:!0}]});xt.afterEach((function(t){n.default.nextTick((function(){$(".modal.show").modal("hide"),$(".modal-backdrop").remove(),$("body").removeClass("modal-open").css({overflow:"","padding-right":""})})),"starmap"===t.name&&n.default.nextTick((function(){requestAnimationFrame((function(){window.__starmap&&window.__starmap.invalidateSize(!0)}))}))}));new n.default({router:xt,components:{Bookmark:c,Construction:u,Demolish:d,Mailbox:U,Message:D,Monitor:E,Mothership:H,Move:F,Navigation:J,Planet:Q,Player:Z,Profile:X,Setting:K,Sidebar:tt,Star:et,Trophy:ht,Upgrade:vt,UpgradeAll:bt},mixins:[z]}).$mount("#app")},9147:(t,e,i)=>{"use strict";i.r(e);var n=i(4554);window._=i(6486);try{window.Popper=i(8981).default,window.$=window.jQuery=i(9755),i(3734)}catch(t){}window.axios=i(9669),window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";var r=document.head.querySelector('meta[name="csrf-token"]');r?window.axios.defaults.headers.common["X-CSRF-TOKEN"]=r.content:console.error("CSRF token not found: https://laravel.com/docs/csrf#csrf-x-csrf-token"),window.Pusher=i(6606),window.Echo=new n.Z({broadcaster:"pusher",key:window.PUSHER_APP_KEY,wsHost:window.location.hostname,wsPort:window.location.port,wsPath:"/ws",disableStats:!0,enabledTransports:["ws","wss"]}),window.Vue=i(538),window.Swal=i(6455),window.moment=i(381),moment.locale(document.querySelector("html").getAttribute("lang")),i(5243),i(1134),i(4772),function(){function t(){document.documentElement.style.setProperty("--app-vh",window.innerHeight+"px")}t(),window.addEventListener("resize",t),window.addEventListener("orientationchange",(function(){setTimeout(t,150)}))}(),window.axios.interceptors.response.use(null,(function(t){var e=_.get(t.response,"status");return 419===e?Swal.fire({icon:"warning",title:Translations.error.whoops,text:"Session expired. The page will reload.",showConfirmButton:!1,timer:1500}).then((function(){window.location.reload()})):401===e?window.location.href="/login":403===e?Swal.fire({icon:"warning",title:Translations.error.whoops,text:"Permission denied.",showConfirmButton:!1,timer:1500}):422===e||e>=500&&Swal.fire({icon:"error",title:Translations.error.whoops,text:Translations.error.wrong,showConfirmButton:!1,timer:1500}),Promise.reject(t)}))},4308:()=>{},6700:(t,e,i)=>{var n={"./af":2786,"./af.js":2786,"./ar":867,"./ar-dz":4130,"./ar-dz.js":4130,"./ar-kw":6135,"./ar-kw.js":6135,"./ar-ly":6440,"./ar-ly.js":6440,"./ar-ma":7702,"./ar-ma.js":7702,"./ar-sa":6040,"./ar-sa.js":6040,"./ar-tn":7100,"./ar-tn.js":7100,"./ar.js":867,"./az":1083,"./az.js":1083,"./be":9808,"./be.js":9808,"./bg":8338,"./bg.js":8338,"./bm":7438,"./bm.js":7438,"./bn":8905,"./bn-bd":6225,"./bn-bd.js":6225,"./bn.js":8905,"./bo":1560,"./bo.js":1560,"./br":1278,"./br.js":1278,"./bs":622,"./bs.js":622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":877,"./cv.js":877,"./cy":7373,"./cy.js":7373,"./da":4780,"./da.js":4780,"./de":9740,"./de-at":217,"./de-at.js":217,"./de-ch":894,"./de-ch.js":894,"./de.js":9740,"./dv":5300,"./dv.js":5300,"./el":837,"./el.js":837,"./en-au":8348,"./en-au.js":8348,"./en-ca":7925,"./en-ca.js":7925,"./en-gb":2243,"./en-gb.js":2243,"./en-ie":6436,"./en-ie.js":6436,"./en-il":7207,"./en-il.js":7207,"./en-in":4175,"./en-in.js":4175,"./en-nz":6319,"./en-nz.js":6319,"./en-sg":1662,"./en-sg.js":1662,"./eo":2915,"./eo.js":2915,"./es":5655,"./es-do":5251,"./es-do.js":5251,"./es-mx":6112,"./es-mx.js":6112,"./es-us":1146,"./es-us.js":1146,"./es.js":5655,"./et":5603,"./et.js":5603,"./eu":7763,"./eu.js":7763,"./fa":6959,"./fa.js":6959,"./fi":1897,"./fi.js":1897,"./fil":2549,"./fil.js":2549,"./fo":4694,"./fo.js":4694,"./fr":4470,"./fr-ca":3049,"./fr-ca.js":3049,"./fr-ch":2330,"./fr-ch.js":2330,"./fr.js":4470,"./fy":5044,"./fy.js":5044,"./ga":9295,"./ga.js":9295,"./gd":2101,"./gd.js":2101,"./gl":8794,"./gl.js":8794,"./gom-deva":7884,"./gom-deva.js":7884,"./gom-latn":3168,"./gom-latn.js":3168,"./gu":5349,"./gu.js":5349,"./he":4206,"./he.js":4206,"./hi":94,"./hi.js":94,"./hr":316,"./hr.js":316,"./hu":2138,"./hu.js":2138,"./hy-am":1423,"./hy-am.js":1423,"./id":9218,"./id.js":9218,"./is":135,"./is.js":135,"./it":626,"./it-ch":150,"./it-ch.js":150,"./it.js":626,"./ja":9183,"./ja.js":9183,"./jv":4286,"./jv.js":4286,"./ka":2105,"./ka.js":2105,"./kk":7772,"./kk.js":7772,"./km":8758,"./km.js":8758,"./kn":9282,"./kn.js":9282,"./ko":3730,"./ko.js":3730,"./ku":1408,"./ku.js":1408,"./ky":3291,"./ky.js":3291,"./lb":6841,"./lb.js":6841,"./lo":5466,"./lo.js":5466,"./lt":7010,"./lt.js":7010,"./lv":7595,"./lv.js":7595,"./me":9861,"./me.js":9861,"./mi":5493,"./mi.js":5493,"./mk":5966,"./mk.js":5966,"./ml":7341,"./ml.js":7341,"./mn":5115,"./mn.js":5115,"./mr":370,"./mr.js":370,"./ms":9847,"./ms-my":1237,"./ms-my.js":1237,"./ms.js":9847,"./mt":2126,"./mt.js":2126,"./my":6165,"./my.js":6165,"./nb":4924,"./nb.js":4924,"./ne":6744,"./ne.js":6744,"./nl":3901,"./nl-be":9814,"./nl-be.js":9814,"./nl.js":3901,"./nn":3877,"./nn.js":3877,"./oc-lnc":2135,"./oc-lnc.js":2135,"./pa-in":5858,"./pa-in.js":5858,"./pl":4495,"./pl.js":4495,"./pt":9520,"./pt-br":7971,"./pt-br.js":7971,"./pt.js":9520,"./ro":6459,"./ro.js":6459,"./ru":1793,"./ru.js":1793,"./sd":950,"./sd.js":950,"./se":490,"./se.js":490,"./si":124,"./si.js":124,"./sk":4249,"./sk.js":4249,"./sl":4985,"./sl.js":4985,"./sq":1104,"./sq.js":1104,"./sr":9131,"./sr-cyrl":9915,"./sr-cyrl.js":9915,"./sr.js":9131,"./ss":5893,"./ss.js":5893,"./sv":8760,"./sv.js":8760,"./sw":1172,"./sw.js":1172,"./ta":7333,"./ta.js":7333,"./te":3110,"./te.js":3110,"./tet":2095,"./tet.js":2095,"./tg":7321,"./tg.js":7321,"./th":9041,"./th.js":9041,"./tk":9005,"./tk.js":9005,"./tl-ph":5768,"./tl-ph.js":5768,"./tlh":9444,"./tlh.js":9444,"./tr":2397,"./tr.js":2397,"./tzl":8254,"./tzl.js":8254,"./tzm":1106,"./tzm-latn":699,"./tzm-latn.js":699,"./tzm.js":1106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":7691,"./uk.js":7691,"./ur":3795,"./ur.js":3795,"./uz":6791,"./uz-latn":588,"./uz-latn.js":588,"./uz.js":6791,"./vi":5666,"./vi.js":5666,"./x-pseudo":4378,"./x-pseudo.js":4378,"./yo":5805,"./yo.js":5805,"./zh-cn":3839,"./zh-cn.js":3839,"./zh-hk":5726,"./zh-hk.js":5726,"./zh-mo":9807,"./zh-mo.js":9807,"./zh-tw":4152,"./zh-tw.js":4152};function r(t){var e=s(t);return i(e)}function s(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}r.keys=function(){return Object.keys(n)},r.resolve=s,t.exports=r,r.id=6700}},t=>{"use strict";var e=e=>t(t.s=e);t.O(void 0,[170,898],(()=>(e(5077),e(4308))))}]);